<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />

<meta name="viewport" content="width=device-width, initial-scale=1">


<meta name="date" content="2018-04-15" />

<title>LufthansaR</title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>



<link href="data:text/css;charset=utf-8,body%20%7B%0Abackground%2Dcolor%3A%20%23fff%3B%0Amargin%3A%201em%20auto%3B%0Amax%2Dwidth%3A%20700px%3B%0Aoverflow%3A%20visible%3B%0Apadding%2Dleft%3A%202em%3B%0Apadding%2Dright%3A%202em%3B%0Afont%2Dfamily%3A%20%22Open%20Sans%22%2C%20%22Helvetica%20Neue%22%2C%20Helvetica%2C%20Arial%2C%20sans%2Dserif%3B%0Afont%2Dsize%3A%2014px%3B%0Aline%2Dheight%3A%201%2E35%3B%0A%7D%0A%23header%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0A%23TOC%20%7B%0Aclear%3A%20both%3B%0Amargin%3A%200%200%2010px%2010px%3B%0Apadding%3A%204px%3B%0Awidth%3A%20400px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Aborder%2Dradius%3A%205px%3B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Afont%2Dsize%3A%2013px%3B%0Aline%2Dheight%3A%201%2E3%3B%0A%7D%0A%23TOC%20%2Etoctitle%20%7B%0Afont%2Dweight%3A%20bold%3B%0Afont%2Dsize%3A%2015px%3B%0Amargin%2Dleft%3A%205px%3B%0A%7D%0A%23TOC%20ul%20%7B%0Apadding%2Dleft%3A%2040px%3B%0Amargin%2Dleft%3A%20%2D1%2E5em%3B%0Amargin%2Dtop%3A%205px%3B%0Amargin%2Dbottom%3A%205px%3B%0A%7D%0A%23TOC%20ul%20ul%20%7B%0Amargin%2Dleft%3A%20%2D2em%3B%0A%7D%0A%23TOC%20li%20%7B%0Aline%2Dheight%3A%2016px%3B%0A%7D%0Atable%20%7B%0Amargin%3A%201em%20auto%3B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dcolor%3A%20%23DDDDDD%3B%0Aborder%2Dstyle%3A%20outset%3B%0Aborder%2Dcollapse%3A%20collapse%3B%0A%7D%0Atable%20th%20%7B%0Aborder%2Dwidth%3A%202px%3B%0Apadding%3A%205px%3B%0Aborder%2Dstyle%3A%20inset%3B%0A%7D%0Atable%20td%20%7B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dstyle%3A%20inset%3B%0Aline%2Dheight%3A%2018px%3B%0Apadding%3A%205px%205px%3B%0A%7D%0Atable%2C%20table%20th%2C%20table%20td%20%7B%0Aborder%2Dleft%2Dstyle%3A%20none%3B%0Aborder%2Dright%2Dstyle%3A%20none%3B%0A%7D%0Atable%20thead%2C%20table%20tr%2Eeven%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Ap%20%7B%0Amargin%3A%200%2E5em%200%3B%0A%7D%0Ablockquote%20%7B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Apadding%3A%200%2E25em%200%2E75em%3B%0A%7D%0Ahr%20%7B%0Aborder%2Dstyle%3A%20solid%3B%0Aborder%3A%20none%3B%0Aborder%2Dtop%3A%201px%20solid%20%23777%3B%0Amargin%3A%2028px%200%3B%0A%7D%0Adl%20%7B%0Amargin%2Dleft%3A%200%3B%0A%7D%0Adl%20dd%20%7B%0Amargin%2Dbottom%3A%2013px%3B%0Amargin%2Dleft%3A%2013px%3B%0A%7D%0Adl%20dt%20%7B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0Aul%20%7B%0Amargin%2Dtop%3A%200%3B%0A%7D%0Aul%20li%20%7B%0Alist%2Dstyle%3A%20circle%20outside%3B%0A%7D%0Aul%20ul%20%7B%0Amargin%2Dbottom%3A%200%3B%0A%7D%0Apre%2C%20code%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0Aborder%2Dradius%3A%203px%3B%0Acolor%3A%20%23333%3B%0Awhite%2Dspace%3A%20pre%2Dwrap%3B%20%0A%7D%0Apre%20%7B%0Aborder%2Dradius%3A%203px%3B%0Amargin%3A%205px%200px%2010px%200px%3B%0Apadding%3A%2010px%3B%0A%7D%0Apre%3Anot%28%5Bclass%5D%29%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Acode%20%7B%0Afont%2Dfamily%3A%20Consolas%2C%20Monaco%2C%20%27Courier%20New%27%2C%20monospace%3B%0Afont%2Dsize%3A%2085%25%3B%0A%7D%0Ap%20%3E%20code%2C%20li%20%3E%20code%20%7B%0Apadding%3A%202px%200px%3B%0A%7D%0Adiv%2Efigure%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0Aimg%20%7B%0Abackground%2Dcolor%3A%20%23FFFFFF%3B%0Apadding%3A%202px%3B%0Aborder%3A%201px%20solid%20%23DDDDDD%3B%0Aborder%2Dradius%3A%203px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Amargin%3A%200%205px%3B%0A%7D%0Ah1%20%7B%0Amargin%2Dtop%3A%200%3B%0Afont%2Dsize%3A%2035px%3B%0Aline%2Dheight%3A%2040px%3B%0A%7D%0Ah2%20%7B%0Aborder%2Dbottom%3A%204px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Apadding%2Dbottom%3A%202px%3B%0Afont%2Dsize%3A%20145%25%3B%0A%7D%0Ah3%20%7B%0Aborder%2Dbottom%3A%202px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Afont%2Dsize%3A%20120%25%3B%0A%7D%0Ah4%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23f7f7f7%3B%0Amargin%2Dleft%3A%208px%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Ah5%2C%20h6%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23ccc%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Aa%20%7B%0Acolor%3A%20%230033dd%3B%0Atext%2Ddecoration%3A%20none%3B%0A%7D%0Aa%3Ahover%20%7B%0Acolor%3A%20%236666ff%3B%20%7D%0Aa%3Avisited%20%7B%0Acolor%3A%20%23800080%3B%20%7D%0Aa%3Avisited%3Ahover%20%7B%0Acolor%3A%20%23BB00BB%3B%20%7D%0Aa%5Bhref%5E%3D%22http%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0Aa%5Bhref%5E%3D%22https%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0A%0Acode%20%3E%20span%2Ekw%20%7B%20color%3A%20%23555%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Edt%20%7B%20color%3A%20%23902000%3B%20%7D%20%0Acode%20%3E%20span%2Edv%20%7B%20color%3A%20%2340a070%3B%20%7D%20%0Acode%20%3E%20span%2Ebn%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Efl%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Ech%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Est%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Eco%20%7B%20color%3A%20%23888888%3B%20font%2Dstyle%3A%20italic%3B%20%7D%20%0Acode%20%3E%20span%2Eot%20%7B%20color%3A%20%23007020%3B%20%7D%20%0Acode%20%3E%20span%2Eal%20%7B%20color%3A%20%23ff0000%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Efu%20%7B%20color%3A%20%23900%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%20code%20%3E%20span%2Eer%20%7B%20color%3A%20%23a61717%3B%20background%2Dcolor%3A%20%23e3d2d2%3B%20%7D%20%0A" rel="stylesheet" type="text/css" />

</head>

<body>




<h1 class="title toc-ignore">LufthansaR</h1>
<h4 class="date"><em>2018-04-15</em></h4>


<div id="TOC">
<ul>
<li><a href="#introduction-to-lufthansar">Introduction to LufthansaR</a></li>
<li><a href="#lufthansa-open-api">Lufthansa Open API</a></li>
<li><a href="#how-to-install-lufthansar">How to install LufthansaR</a></li>
<li><a href="#usage">Usage</a></li>
<li><a href="#how-to-deal-with-lufthansa-open-api-credentials">How to deal with Lufthansa Open API credentials</a></li>
<li><a href="#how-to-see-the-active-token-used">How to see the active token used</a></li>
<li><a href="#how-to-get-flight-status">How to get flight status</a></li>
<li><a href="#getting-status-of-flights-arriving-at-a-particular-airport">Getting status of flights arriving at a particular airport</a></li>
<li><a href="#getting-status-of-flights-departing-from-a-particular-airport">Getting status of flights departing from a particular airport</a></li>
</ul>
</div>

<div id="introduction-to-lufthansar" class="section level2">
<h2>Introduction to LufthansaR</h2>
<p><code>LufthansaR</code> is an API wrapper package for R. It enables programmers to access to <a href="https://developer.lufthansa.com/docs">Lufthansa Open API</a> from R environment.</p>
<p>This document introduces you to LufthansaR’s basic set of tools, and show how to use them. Once you have installed the package, read <code>vignette(&quot;LufthansaR&quot;)</code> to learn more.</p>
</div>
<div id="lufthansa-open-api" class="section level2">
<h2>Lufthansa Open API</h2>
<p>To have access to Lufthansa Open API, one has to sign in to Mashery, Lufthansa’s developer platform, and apply for a key. Please visit <a href="https://developer.lufthansa.com/docs/API_basics/">here</a>. Once you are registered, you will be given:</p>
<ul>
<li>a key and</li>
<li>a secret</li>
</ul>
<p>These two values can be exchanged for a <em>short-lived</em> access token. A valid access token must be sent with every API request while accessing any Lufthansa’s API. In other words, every Lufthansa API requires you to pass Oauth token when getting the data from it.</p>
</div>
<div id="how-to-install-lufthansar" class="section level2">
<h2>How to install LufthansaR</h2>
<p>You can install <code>LufthansaR</code> development version from GitHub</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">devtools::<span class="kw">install_github</span>(<span class="st">&quot;peter0083/LufthansaR&quot;</span>)</code></pre></div>
<p>CRAN version of the package will be scheduled to be added in the next version.</p>
</div>
<div id="usage" class="section level2">
<h2>Usage</h2>
<p>You can load <code>LufthansaR</code> as follows.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(LufthansaR)</code></pre></div>
<p>This will load the core <code>lufthansaR</code> functions.</p>
</div>
<div id="how-to-deal-with-lufthansa-open-api-credentials" class="section level2">
<h2>How to deal with Lufthansa Open API credentials</h2>
<p>You can store your client ID and secret in a <code>~/.Renviron</code> file. R loads this file as a system variable in each new session. The package uses these variables to request new keys if needed. The <code>.Renviron</code> file should contain the lines</p>
<pre><code>LUFTHANSA_API_CLIENT_ID = 'xxxxxxxxxxxxxxxxxxxxxxxx'
LUFTHANSA_API_CLIENT_SECRET = 'xxxxxxxxxx'</code></pre>
<p>which specify the key and secret pair. This package does not remember the id or the secret.</p>
<p><strong>NOTE: The name of the variables should be EXACTLY:</strong></p>
<ul>
<li><code>LUFTHANSA_API_CLIENT_ID</code></li>
<li><code>LUFTHANSA_API_CLIENT_SECRET</code></li>
</ul>
<p>Because tokens last for 1.5 days and to prevent the abuse of continuously requesting new tokens, the package by default stores the token and its expiry in a file in the working directory called <code>.lufthansa-token</code>. Caching the token provides a way of using it across R sessions until it expires. Functions in the package use the <code>get_token()</code> command to access the API. For more information about the function, see <code>help(get_token)</code>.</p>
<p>Caching the token can be turned off by setting the following R option through</p>
<pre><code>options(lufthansar_token_cache = FALSE)</code></pre>
<p>Alternately, one can choose where to cache the token by using a filename instead</p>
<pre><code>options(lufthansar_token_cache = 'path/to/.token-cache')</code></pre>
<p>Users can see the token being used and its expiry by calling</p>
<pre><code>LufthansaR::get_creds_from_env()</code></pre>
</div>
<div id="how-to-see-the-active-token-used" class="section level2">
<h2>How to see the active token used</h2>
<p>Get the current token being used by the package.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">LufthansaR::<span class="kw">get_token</span>()</code></pre></div>
<pre><code>## [1] &quot;6pfhtrdpejwjv5qd86wemg7w&quot;</code></pre>
<p>Each token is valid for a specified period of time. When the token is valid, <code>LufthansaR</code> uses the <code>Client ID</code> and <code>Client Secret</code> in your <code>.Renviron</code>.</p>
</div>
<div id="how-to-get-flight-status" class="section level2">
<h2>How to get flight status</h2>
<p>This <code>get_flight_status()</code> function will print out the flight information</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">f_status &lt;-<span class="st"> </span>LufthansaR::<span class="kw">get_flight_status</span>(<span class="st">&quot;LH493&quot;</span>)</code></pre></div>
<pre><code>## Flight LH493 on 2018-04-15
## Scheduled Departure from YVR at 2018-04-15T16:20 from terminal M.
## Departure Status: Flight On Time
## Scheduled Arrival at FRA at 2018-04-16T11:05 at terminal 1.
## Arrival Status: Flight On Time</code></pre>
<p>The default is the flight status for today. However, you can call 5 days into the future by passing <code>dep_date=&quot;2018-04-15&quot;</code> argument. The departure date (YYYY-MM-DD) in the local time of the departure airport.</p>
<p>Since the function returns <code>httr</code> content object, you can access to different attributes of the content:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Departure Airport abbreviation</span>
f_status$Departure$AirportCode</code></pre></div>
<pre><code>## [1] &quot;YVR&quot;</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Scheduled Departure Time (departure local time)</span>
f_status$Departure$ScheduledTimeLocal$DateTime</code></pre></div>
<pre><code>## [1] &quot;2018-04-15T16:20&quot;</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Departure Terminal</span>
f_status$Departure$Terminal$Name</code></pre></div>
<pre><code>## [1] &quot;M&quot;</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Departure Status</span>
f_status$Departure$TimeStatus$Definition</code></pre></div>
<pre><code>## [1] &quot;Flight On Time&quot;</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Arrival Airport abbreviation</span>
f_status$Arrival$AirportCode</code></pre></div>
<pre><code>## [1] &quot;FRA&quot;</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Scheduled Arrival Time (arrival local time)</span>
f_status$Arrival$ScheduledTimeLocal$DateTime</code></pre></div>
<pre><code>## [1] &quot;2018-04-16T11:05&quot;</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Arrival Terminal</span>
f_status$Arrival$Terminal$Name</code></pre></div>
<pre><code>## [1] 1</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Arrival Status</span>
f_status$Arrival$TimeStatus$Definition</code></pre></div>
<pre><code>## [1] &quot;Flight On Time&quot;</code></pre>
</div>
<div id="getting-status-of-flights-arriving-at-a-particular-airport" class="section level2">
<h2>Getting status of flights arriving at a particular airport</h2>
<p>Let’s load some packages that we will use below.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">suppressPackageStartupMessages</span>(<span class="kw">library</span>(tidyverse))
<span class="kw">suppressPackageStartupMessages</span>(<span class="kw">library</span>(ggmap))
<span class="kw">suppressPackageStartupMessages</span>(<span class="kw">library</span>(lubridate))</code></pre></div>
<p>To obtain the information about flights at the arrival airport,</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">get_flight_status_arrival</span>(<span class="dt">airport =</span> <span class="st">&quot;YVR&quot;</span>, <span class="dt">fromDateTime =</span> <span class="st">&quot;2018-04-13T00:00&quot;</span>)</code></pre></div>
<p>The output is the <code>httr</code> parsed content. The format of <code>fromDateTime</code> is <code>YYYY-MM-DDTHH:MM</code>. This is ISO-8601 date format. Let’s assume that we are interested in flights arriving at <code>FRA</code> around this time. And let’s assume we are interested in showing some departure delays of those flights in a visualization.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># This to get the current local time at FRA and convert it to the ISO-8601 format.</span>
tm &lt;-<span class="st"> </span><span class="kw">as.POSIXlt</span>(<span class="kw">Sys.time</span>(), <span class="dt">tz=</span><span class="st">&quot;Europe/Berlin&quot;</span>, <span class="st">&quot;%Y-%m-%dT%H:%M&quot;</span>)
tm_FRA &lt;-<span class="st"> </span><span class="kw">strftime</span>(tm,  <span class="st">&quot;%Y-%m-%dT%H:%M&quot;</span>)
<span class="co"># to parse the content</span>
parsed_content &lt;-<span class="st"> </span><span class="kw">get_flight_status_arrival</span>(<span class="dt">airport =</span> <span class="st">&quot;FRA&quot;</span>, <span class="dt">fromDateTime =</span> tm_FRA)</code></pre></div>
<p>You can see the content return by typing <code>parsed_content</code>. It is possible that there might not be any flight arriving at the time specified. Let’s first see how many flights the API returns.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">if (parsed_content$FlightStatusResource$Meta$TotalCount ==<span class="st"> </span><span class="dv">1</span>){
  
  (no_flight_returned &lt;-parsed_content$FlightStatusResource$Meta$TotalCount)
  
} else{
  
  (no_flight_returned &lt;-<span class="st"> </span><span class="kw">summary</span>(parsed_content$FlightStatusResource$Flights)[<span class="dv">1</span>])
  
}</code></pre></div>
<pre><code>## [1] &quot;20&quot;</code></pre>
<p>In the following, a visualization is created by using the return content for departure delay for those flight arriving at FRA.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># The following is performed if the API returns some flight information</span>
if(!(<span class="kw">is.nan</span>(no_flight_returned) |<span class="st"> </span>no_flight_returned &lt;=<span class="st"> </span><span class="dv">1</span>)){
  flight_departure_data &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">dept_airport =</span> <span class="kw">rep</span>(<span class="ot">NA</span>, no_flight_returned), 
            <span class="dt">scheduled_dept =</span><span class="kw">rep</span>(<span class="ot">NA</span>, no_flight_returned), <span class="dt">actual_dept =</span><span class="kw">rep</span>(<span class="ot">NA</span>, no_flight_returned))
  
  <span class="co"># wrangle the data</span>
  for (i in <span class="dv">1</span>:no_flight_returned){
  
    flight_departure_data$dept_airport[i] &lt;-<span class="st"> </span>
<span class="st">      </span>parsed_content$FlightStatusResource$Flights[[<span class="dv">1</span>]][[i]]$Departure$AirportCode
  
    flight_departure_data$scheduled_dept[i] &lt;-<span class="st">  </span>
<span class="st">      </span>parsed_content$FlightStatusResource$Flights[[<span class="dv">1</span>]][[i]]$Departure$ScheduledTimeLocal$DateTime
  
    flight_departure_data$actual_dept[i] &lt;-<span class="st"> </span>
<span class="st">      </span><span class="kw">ifelse</span> (<span class="kw">is.null</span>(parsed_content$FlightStatusResource$Flights[[<span class="dv">1</span>]][[i]]$Departure$ActualTimeLocal$DateTime), <span class="ot">NA</span>, parsed_content$FlightStatusResource$Flights[[<span class="dv">1</span>]][[i]]$Departure$ActualTimeLocal$DateTime)
  }
  
  <span class="co"># clean the json data</span>
  flight_departure_data$delay &lt;-
<span class="st">    </span>-<span class="kw">as.numeric</span>(<span class="kw">as.duration</span>(<span class="kw">interval</span>(<span class="kw">ymd_hm</span>(flight_departure_data$actual_dept),                                                                          <span class="kw">ymd_hm</span>(flight_departure_data$scheduled_dept))), <span class="st">&quot;minutes&quot;</span>)
  flight_departure_data&lt;-<span class="st"> </span>flight_departure_data %&gt;%<span class="st"> </span>
<span class="st">    </span><span class="kw">mutate</span>(<span class="dt">status =</span> <span class="kw">ifelse</span>(<span class="kw">is.na</span>(delay), <span class="st">&quot;not departed&quot;</span>, 
                         <span class="kw">ifelse</span>(delay&gt;<span class="dv">0</span>, <span class="st">&quot;delayed departure&quot;</span>, <span class="st">&quot;early/on-time&quot;</span>))) %&gt;%<span class="st"> </span>
<span class="st">    </span><span class="kw">mutate</span>(<span class="dt">delay =</span> <span class="kw">ifelse</span>(<span class="kw">is.na</span>(delay), <span class="dv">1</span>,  delay)) 
  
  <span class="co"># visualize the result</span>
  <span class="kw">ggplot</span>(<span class="dt">data=</span>flight_departure_data, <span class="kw">aes</span>(<span class="dt">x=</span><span class="kw">as.factor</span>(dept_airport), <span class="dt">y=</span>delay)) +
<span class="st">    </span><span class="kw">geom_bar</span>(<span class="dt">stat=</span><span class="st">&quot;identity&quot;</span>, <span class="kw">aes</span>(<span class="dt">fill=</span>status)) +<span class="st"> </span>
<span class="st">    </span><span class="kw">coord_flip</span>() +
<span class="st">    </span><span class="kw">ggtitle</span>(<span class="kw">paste0</span>(<span class="st">&quot;Delay Status at the Departure Airports for the Flights arriving at &quot;</span>, <span class="st">&quot;FRA&quot;</span>)) +
<span class="st">    </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;bottom&quot;</span>) +
<span class="st">    </span><span class="kw">xlab</span>(<span class="st">&quot;Airport&quot;</span>) +
<span class="st">    </span><span class="kw">ylab</span>(<span class="st">&quot;Delay (minutes)&quot;</span>)
  } else {
    
  <span class="kw">print</span>(<span class="st">&quot;No more than one flight information available at this time!&quot;</span>)

}</code></pre></div>
<p><img src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
</div>
<div id="getting-status-of-flights-departing-from-a-particular-airport" class="section level2">
<h2>Getting status of flights departing from a particular airport</h2>
<p>To obtain the information about flights at the departure airport,</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">get_flight_status_departure</span>(<span class="dt">airport =</span> <span class="st">&quot;YVR&quot;</span>, <span class="dt">fromDateTime =</span> <span class="st">&quot;2018-04-13T00:00&quot;</span>)</code></pre></div>
<p>The output is the <code>httr</code> parsed content. The format of <code>fromDateTime</code> is <code>YYYY-MM-DDTHH:MM</code>. This is ISO-8601 date format. Let’s assume that we are interested in flights departing from <code>FRA</code> around this time.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># This to get the current local time at FRA and convert it to the ISO-8601 format.</span>
tm &lt;-<span class="st"> </span><span class="kw">as.POSIXlt</span>(<span class="kw">Sys.time</span>(), <span class="dt">tz=</span><span class="st">&quot;Europe/Berlin&quot;</span>, <span class="st">&quot;%Y-%m-%dT%H:%M&quot;</span>)
tm_FRA &lt;-<span class="st"> </span><span class="kw">strftime</span>(tm,  <span class="st">&quot;%Y-%m-%dT%H:%M&quot;</span>)

<span class="co"># to parse the content</span>
parsed_content &lt;-<span class="st"> </span><span class="kw">get_flight_status_departure</span>(<span class="dt">airport =</span> <span class="st">&quot;FRA&quot;</span>, <span class="dt">fromDateTime =</span> tm_FRA)</code></pre></div>
<p>You can see the content return by typing <code>parsed_content</code>. It is possible that there might not be any flight arriving at the time specified. It is possible that there might not be any flight arriving at the time specified. Let’s first see how many flights the API returns.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># to count the number of flights returned</span>

if (parsed_content$FlightStatusResource$Meta$TotalCount ==<span class="st"> </span><span class="dv">1</span>){

  (no_flight_returned &lt;-parsed_content$FlightStatusResource$Meta$TotalCount)

  } else {
    
  (no_flight_returned &lt;-<span class="st"> </span><span class="kw">summary</span>(parsed_content$FlightStatusResource$Flights)[<span class="dv">1</span>])

}</code></pre></div>
<pre><code>## [1] &quot;20&quot;</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># The following is performed if the API returns more than one flight</span>

if(!(<span class="kw">is.nan</span>(no_flight_returned) |<span class="st"> </span>no_flight_returned &lt;=<span class="st"> </span><span class="dv">1</span>)){
  flight_departure_data &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">flight_code =</span> <span class="kw">rep</span>(<span class="ot">NA</span>, no_flight_returned), 
            <span class="dt">scheduled_dept =</span><span class="kw">rep</span>(<span class="ot">NA</span>, no_flight_returned), <span class="dt">destination_airport =</span><span class="kw">rep</span>(<span class="ot">NA</span>, no_flight_returned), <span class="dt">arrival_time =</span><span class="kw">rep</span>(<span class="ot">NA</span>, no_flight_returned))
  
  <span class="co"># data wrangling</span>
  for (i in <span class="dv">1</span>:no_flight_returned){
  
    flight_departure_data$flight_code[i] &lt;-<span class="st"> </span>
<span class="st">      </span><span class="kw">paste0</span>( parsed_content$FlightStatusResource$Flights[[<span class="dv">1</span>]][[i]]$MarketingCarrier$AirlineID,parsed_content$FlightStatusResource$Flights[[<span class="dv">1</span>]][[i]]$MarketingCarrier$FlightNumber)
  
    flight_departure_data$scheduled_dept[i] &lt;-<span class="st">  </span>
<span class="st">      </span>parsed_content$FlightStatusResource$Flights[[<span class="dv">1</span>]][[i]]$Departure$ScheduledTimeLocal$DateTime
  
    flight_departure_data$destination_airport[i] &lt;-<span class="st"> </span>parsed_content$FlightStatusResource$Flights[[<span class="dv">1</span>]][[i]]$Arrival$AirportCode
    
    flight_departure_data$arrival_time[i] &lt;-<span class="st"> </span>parsed_content$FlightStatusResource$Flights[[<span class="dv">1</span>]][[i]]$Arrival$ScheduledTimeLocal
  }
  
flight_departure_data
  
} else {
  
  <span class="kw">print</span>(<span class="st">&quot;No flight information available at this time!&quot;</span>)

}</code></pre></div>
<pre><code>##    flight_code   scheduled_dept destination_airport     arrival_time
## 1       LH1074 2018-04-15T08:50                 LYS 2018-04-15T10:05
## 2       LH1470 2018-04-15T09:10                 TSR 2018-04-15T12:00
## 3       LH1158 2018-04-15T09:10                 PMI 2018-04-15T11:15
## 4       LH1166 2018-04-15T09:10                 LIS 2018-04-15T11:10
## 5       LH1358 2018-04-15T09:10                 WRO 2018-04-15T10:25
## 6        LH074 2018-04-15T09:10                 DUS 2018-04-15T10:00
## 7        LH810 2018-04-15T09:10                 GOT 2018-04-15T10:45
## 8       LH1148 2018-04-15T09:10                 AGP 2018-04-15T12:05
## 9        LH836 2018-04-15T09:10                 BLL 2018-04-15T10:25
## 10       LH352 2018-04-15T09:10                 BRE 2018-04-15T10:05
## 11       LH248 2018-04-15T09:10                 MXP 2018-04-15T10:20
## 12       LH098 2018-04-15T09:15                 MUC 2018-04-15T10:10
## 13      LH1432 2018-04-15T09:15                 LED 2018-04-15T12:55
## 14       LH128 2018-04-15T09:15                 STR 2018-04-15T09:55
## 15       AC873 2018-04-15T09:20                 YYZ 2018-04-15T11:35
## 16       LH206 2018-04-15T09:20                 DRS 2018-04-15T10:15
## 17      LH1030 2018-04-15T09:20                 CDG 2018-04-15T10:30
## 18       JP117 2018-04-15T09:20                 LJU 2018-04-15T10:30
## 19       OU413 2018-04-15T09:25                 SPU 2018-04-15T11:05
## 20      LH1008 2018-04-15T09:25                 BRU 2018-04-15T10:20</code></pre>
</div>



<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
